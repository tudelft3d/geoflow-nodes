cmake_minimum_required(VERSION 3.14)
project (processing-stepedge VERSION 0.0.1)

add_definitions(-DGF_PLUGIN_NAME=\"${CMAKE_PROJECT_NAME}\")

find_package(geoflow REQUIRED)

# ptinpoly
add_library(ptinpoly STATIC thirdparty/ptinpoly/ptinpoly.c)
set_target_properties(
  ptinpoly
  PROPERTIES C_STANDARD 11
)
include_directories(thirdparty/ptinpoly)

find_package(glm)
find_package(LASlib)
find_package(CGAL QUIET COMPONENTS Core)
#earcut
include_directories(
  thirdparty/earcut
)

if (MSVC)
  set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /fp:precise")
endif()

add_library(gfp_stepedge MODULE
  plugin.cpp
  stepedge_nodes.cpp
  point_edge.cpp
  region_growing_plane.cpp
  region_growing.cpp
)
target_link_libraries( gfp_stepedge
  geoflow-core
  ptinpoly
  glm
  CGAL::CGAL CGAL::CGAL_Core
  LASlib
)
set_target_properties(
  gfp_stepedge
  PROPERTIES CXX_STANDARD 17
)
install(TARGETS gfp_stepedge DESTINATION ${geoflow_PLUGIN_FOLDER})